(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-124365a0"],{1538:function(t,e,r){"use strict";r.d(e,"g",(function(){return o})),r.d(e,"b",(function(){return a})),r.d(e,"f",(function(){return i})),r.d(e,"l",(function(){return s})),r.d(e,"m",(function(){return l})),r.d(e,"i",(function(){return c})),r.d(e,"h",(function(){return u})),r.d(e,"e",(function(){return d})),r.d(e,"j",(function(){return f})),r.d(e,"a",(function(){return m})),r.d(e,"k",(function(){return _})),r.d(e,"c",(function(){return h})),r.d(e,"d",(function(){return p}));var n=r("b775");function o(t){return Object(n["a"])({url:"/flowable/definition/list",method:"get",params:t})}function a(t,e){return Object(n["a"])({url:"/flowable/definition/start/"+t,method:"post",data:e})}function i(t){return Object(n["a"])({url:"/flowable/task/processVariables/"+t,method:"get"})}function s(t){return Object(n["a"])({url:"/flowable/definition/updateState",method:"put",params:t})}function l(t){return Object(n["a"])({url:"/flowable/definition/userList",method:"get",params:t})}function c(t){return Object(n["a"])({url:"/flowable/definition/roleList",method:"get",params:t})}function u(t){return Object(n["a"])({url:"/flowable/definition/readXml/"+t,method:"get"})}function d(t,e){return Object(n["a"])({url:"/flowable/task/flowViewer/"+t+"/"+e,method:"get"})}function f(t){return Object(n["a"])({url:"/flowable/definition/save",method:"post",data:t})}function m(t){return Object(n["a"])({url:"/system/deployment",method:"post",data:t})}function _(t){return Object(n["a"])({url:"/system/deployment",method:"put",data:t})}function h(t){return Object(n["a"])({url:"/flowable/definition/"+t,method:"delete"})}function p(t){return Object(n["a"])({url:"/system/deployment/export",method:"get",params:t})}},2638:function(t,e,r){"use strict";function n(){return n=Object.assign||function(t){for(var e,r=1;r<arguments.length;r++)for(var n in e=arguments[r],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},n.apply(this,arguments)}var o=["attrs","props","domProps"],a=["class","style","directives"],i=["on","nativeOn"],s=function(t){return t.reduce((function(t,e){for(var r in e)if(t[r])if(-1!==o.indexOf(r))t[r]=n({},t[r],e[r]);else if(-1!==a.indexOf(r)){var s=t[r]instanceof Array?t[r]:[t[r]],c=e[r]instanceof Array?e[r]:[e[r]];t[r]=s.concat(c)}else if(-1!==i.indexOf(r))for(var u in e[r])if(t[r][u]){var d=t[r][u]instanceof Array?t[r][u]:[t[r][u]],f=e[r][u]instanceof Array?e[r][u]:[e[r][u]];t[r][u]=d.concat(f)}else t[r][u]=e[r][u];else if("hook"==r)for(var m in e[r])t[r][m]=t[r][m]?l(t[r][m],e[r][m]):e[r][m];else t[r]=e[r];else t[r]=e[r];return t}),{})},l=function(t,e){return function(){t&&t.apply(this,arguments),e&&e.apply(this,arguments)}};t.exports=s},"589b":function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("flow-view",{attrs:{xmlData:t.xmlData,taskList:t.taskData}})],1)},o=[],a=r("ae3a"),i=r("d5b1"),s={name:"Flow",components:{bpmnModeler:a["a"],FlowView:i["default"]},props:{xmlData:{type:String,default:""},taskData:{type:Array,default:function(){return[]}}},data:function(){return{}}},l=s,c=r("2877"),u=Object(c["a"])(l,n,o,!1,null,null,null);e["default"]=u.exports},"621a":function(t,e,r){},"6e55":function(t,e,r){"use strict";r.d(e,"d",(function(){return o})),r.d(e,"e",(function(){return a})),r.d(e,"g",(function(){return i})),r.d(e,"f",(function(){return s})),r.d(e,"a",(function(){return l})),r.d(e,"h",(function(){return c})),r.d(e,"b",(function(){return u})),r.d(e,"c",(function(){return d}));var n=r("b775");r("3fd3");function o(t){return Object(n["a"])({url:"/flowable/task/finishedList",method:"get",params:t})}function a(t){return Object(n["a"])({url:"/flowable/task/flowRecord",method:"get",params:t})}function i(t){return Object(n["a"])({url:"/flowable/task/revokeProcess",method:"post",data:t})}function s(t){return Object(n["a"])({url:"/system/deployment/"+t,method:"get"})}function l(t){return Object(n["a"])({url:"/system/deployment",method:"post",data:t})}function c(t){return Object(n["a"])({url:"/system/deployment",method:"put",data:t})}function u(t){return Object(n["a"])({url:"/flowable/instance/delete/?instanceId="+t,method:"delete"})}function d(t){return Object(n["a"])({url:"/system/deployment/export",method:"get",params:t})}},"6e5e":function(t,e,r){"use strict";r("621a")},9718:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"app-container"},[r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",{staticClass:"el-icon-document"},[t._v("基础信息")]),r("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:t.goBack}},[t._v("返回")])],1),t.variableOpen?r("el-col",{attrs:{span:16,offset:6}},[r("div",[r("parser",{key:(new Date).getTime(),attrs:{"form-conf":t.variablesData}})],1),"true"===t.finished?r("div",{staticStyle:{"margin-left":"10%","margin-bottom":"20px","font-size":"14px"}},[r("el-button",{attrs:{icon:"el-icon-edit-outline",type:"success",size:"mini"},on:{click:t.handleComplete}},[t._v("审批")]),r("el-button",{attrs:{icon:"el-icon-refresh-left",type:"warning",size:"mini"},on:{click:t.handleReturn}},[t._v("退回")]),r("el-button",{attrs:{icon:"el-icon-circle-close",type:"danger",size:"mini"},on:{click:t.handleReject}},[t._v("驳回")])],1):t._e()]):t._e(),t.formConfOpen?r("el-col",{attrs:{span:16,offset:4}},[r("div",{staticClass:"test-form"},[r("parser",{key:(new Date).getTime(),ref:"parser",attrs:{"form-conf":t.formConf},on:{submit:t.submitForm,getData:t.getData}})],1)]):t._e()],1),t.flowRecordList?r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",{staticClass:"el-icon-notebook-1"},[t._v("审批记录")])]),r("el-col",{attrs:{span:16,offset:4}},[r("div",{staticClass:"block"},[r("el-timeline",t._l(t.flowRecordList,(function(e,n){return r("el-timeline-item",{key:n,attrs:{icon:t.setIcon(e.finishTime),color:t.setColor(e.finishTime)}},[r("p",{staticStyle:{"font-weight":"700"}},[t._v(t._s(e.taskName))]),r("el-card",{attrs:{"body-style":{padding:"10px"}}},[r("el-descriptions",{staticClass:"margin-top",attrs:{column:1,size:"small",border:""}},[e.assigneeName?r("el-descriptions-item",{attrs:{"label-class-name":"my-label"}},[r("template",{slot:"label"},[r("i",{staticClass:"el-icon-user"}),t._v("实际办理")]),t._v(" "+t._s(e.assigneeName)+" "),r("el-tag",{attrs:{type:"info",size:"mini"}},[t._v(t._s(e.deptName))])],2):t._e(),e.candidate?r("el-descriptions-item",{attrs:{"label-class-name":"my-label"}},[r("template",{slot:"label"},[r("i",{staticClass:"el-icon-user"}),t._v("候选办理")]),t._v(" "+t._s(e.candidate)+" ")],2):t._e(),r("el-descriptions-item",{attrs:{"label-class-name":"my-label"}},[r("template",{slot:"label"},[r("i",{staticClass:"el-icon-date"}),t._v("接收时间")]),t._v(" "+t._s(e.createTime)+" ")],2),e.finishTime?r("el-descriptions-item",{attrs:{"label-class-name":"my-label"}},[r("template",{slot:"label"},[r("i",{staticClass:"el-icon-date"}),t._v("处理时间")]),t._v(" "+t._s(e.finishTime)+" ")],2):t._e(),e.duration?r("el-descriptions-item",{attrs:{"label-class-name":"my-label"}},[r("template",{slot:"label"},[r("i",{staticClass:"el-icon-time"}),t._v("耗时")]),t._v(" "+t._s(e.duration)+" ")],2):t._e(),e.comment?r("el-descriptions-item",{attrs:{"label-class-name":"my-label"}},[r("template",{slot:"label"},[r("i",{staticClass:"el-icon-tickets"}),t._v("处理意见")]),t._v(" "+t._s(e.comment.comment)+" ")],2):t._e()],1)],1)],1)})),1)],1)])],1):t._e(),r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",{staticClass:"el-icon-picture-outline"},[t._v("流程图")])]),r("flow",{attrs:{xmlData:t.xmlData,taskData:t.taskList}})],1),r("el-dialog",{attrs:{title:t.completeTitle,visible:t.completeOpen,width:t.checkSendUser?"60%":"40%","append-to-body":""},on:{"update:visible":function(e){t.completeOpen=e}}},[r("el-form",{ref:"taskForm",attrs:{model:t.taskForm,"label-width":"80px"}},[t.checkSendUser?r("el-form-item",{attrs:{prop:"targetKey"}},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:6,xs:24}},[r("h6",[t._v("部门列表")]),r("div",{staticClass:"head-container"},[r("el-input",{staticStyle:{"margin-bottom":"20px"},attrs:{placeholder:"请输入部门名称",clearable:"",size:"small","prefix-icon":"el-icon-search"},model:{value:t.deptName,callback:function(e){t.deptName=e},expression:"deptName"}})],1),r("div",{staticClass:"head-container"},[r("el-tree",{ref:"tree",attrs:{data:t.deptOptions,props:t.defaultProps,"expand-on-click-node":!1,"filter-node-method":t.filterNode,"default-expand-all":""},on:{"node-click":t.handleNodeClick}})],1)]),r("el-col",{attrs:{span:10,xs:24}},[r("h6",[t._v("待选人员")]),r("el-table",{ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:t.userList,border:""},on:{"selection-change":t.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"50",align:"center"}}),r("el-table-column",{attrs:{label:"用户名",align:"center",prop:"nickName"}}),r("el-table-column",{attrs:{label:"部门",align:"center",prop:"dept.deptName"}})],1)],1),r("el-col",{attrs:{span:8,xs:24}},[r("h6",[t._v("已选人员")]),t._l(t.userData,(function(e,n){return r("el-tag",{key:n,attrs:{closable:""},on:{close:function(r){return t.handleClose(e)}}},[t._v(" "+t._s(e.nickName)+" "+t._s(e.dept.deptName)+" ")])}))],2)],1)],1):t._e(),r("el-form-item",{attrs:{label:"处理意见",prop:"comment",rules:[{required:!0,message:"请输入处理意见",trigger:"blur"}]}},[r("el-input",{attrs:{type:"textarea",placeholder:"请输入处理意见"},model:{value:t.taskForm.comment,callback:function(e){t.$set(t.taskForm,"comment",e)},expression:"taskForm.comment"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(e){t.completeOpen=!1}}},[t._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:t.taskComplete}},[t._v("确 定")])],1)],1),r("el-dialog",{attrs:{title:t.returnTitle,visible:t.returnOpen,width:"40%","append-to-body":""},on:{"update:visible":function(e){t.returnOpen=e}}},[r("el-form",{ref:"taskForm",attrs:{model:t.taskForm,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"退回节点",prop:"targetKey"}},[r("el-radio-group",{model:{value:t.taskForm.targetKey,callback:function(e){t.$set(t.taskForm,"targetKey",e)},expression:"taskForm.targetKey"}},t._l(t.returnTaskList,(function(e){return r("el-radio-button",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.name))])})),1)],1),r("el-form-item",{attrs:{label:"退回意见",prop:"comment",rules:[{required:!0,message:"请输入意见",trigger:"blur"}]}},[r("el-input",{staticStyle:{width:"50%"},attrs:{type:"textarea",placeholder:"请输入意见"},model:{value:t.taskForm.comment,callback:function(e){t.$set(t.taskForm,"comment",e)},expression:"taskForm.comment"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(e){t.returnOpen=!1}}},[t._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:t.taskReturn}},[t._v("确 定")])],1)],1),r("el-dialog",{attrs:{title:t.rejectTitle,visible:t.rejectOpen,width:"40%","append-to-body":""},on:{"update:visible":function(e){t.rejectOpen=e}}},[r("el-form",{ref:"taskForm",attrs:{model:t.taskForm,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"驳回意见",prop:"comment",rules:[{required:!0,message:"请输入意见",trigger:"blur"}]}},[r("el-input",{staticStyle:{width:"50%"},attrs:{type:"textarea",placeholder:"请输入意见"},model:{value:t.taskForm.comment,callback:function(e){t.$set(t.taskForm,"comment",e)},expression:"taskForm.comment"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(e){t.rejectOpen=!1}}},[t._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:t.taskReject}},[t._v("确 定")])],1)],1)],1)},o=[],a=(r("d81d"),r("d3b7"),r("ddb0"),r("a15b"),r("a434"),r("159b"),r("6e55")),i=r("9f75"),s=r("1538"),l=r("e099"),c=r("589b"),u=r("fcb7"),d=(r("542c"),r("ca17")),f=r.n(d),m=r("c0c7"),_={name:"Record",components:{Parser:i["a"],flow:c["default"],Treeselect:f.a},props:{},data:function(){return{xmlData:"",taskList:[],deptName:void 0,deptOptions:void 0,userList:null,defaultProps:{children:"children",label:"label"},queryParams:{deptId:void 0},loading:!0,flowRecordList:[],formConfCopy:{},src:null,rules:{},variablesForm:{},taskForm:{returnTaskShow:!1,delegateTaskShow:!1,defaultTaskShow:!0,sendUserShow:!1,multiple:!1,comment:"",procInsId:"",instanceId:"",deployId:"",taskId:"",procDefId:"",vars:"",targetKey:""},userDataList:[],assignee:null,formConf:{},formConfOpen:!1,variables:[],variablesData:{},variableOpen:!1,returnTaskList:[],finished:"false",completeTitle:null,completeOpen:!1,returnTitle:null,returnOpen:!1,rejectOpen:!1,rejectTitle:null,userData:[],checkSendUser:!1}},created:function(){this.taskForm.deployId=this.$route.query&&this.$route.query.deployId,this.taskForm.taskId=this.$route.query&&this.$route.query.taskId,this.taskForm.procInsId=this.$route.query&&this.$route.query.procInsId,this.taskForm.executionId=this.$route.query&&this.$route.query.executionId,this.taskForm.instanceId=this.$route.query&&this.$route.query.procInsId,this.taskForm.procDefId=this.$route.query&&this.$route.query.procDefId,this.getFlowViewer(this.taskForm.procInsId,this.taskForm.executionId),this.getModelDetail(this.taskForm.deployId),this.taskForm.taskId&&(this.processVariables(this.taskForm.taskId),this.getNextFlowNode(this.taskForm.taskId),this.taskForm.deployId=null),this.getFlowRecordList(this.taskForm.procInsId,this.taskForm.deployId),this.finished=this.$route.query&&this.$route.query.finished},methods:{getTreeselect:function(){var t=this;Object(u["g"])().then((function(e){t.deptOptions=e.data}))},getList:function(){var t=this;Object(m["h"])(this.addDateRange(this.queryParams,this.dateRange)).then((function(e){t.userList=e.rows,t.total=e.total}))},filterNode:function(t,e){return!t||-1!==e.label.indexOf(t)},handleNodeClick:function(t){this.queryParams.deptId=t.id,this.getList()},getModelDetail:function(t){var e=this;Object(s["h"])(t).then((function(t){e.xmlData=t.data}))},getFlowViewer:function(t,e){var r=this;Object(s["e"])(t,e).then((function(t){r.taskList=t.data}))},setIcon:function(t){return t?"el-icon-check":"el-icon-time"},setColor:function(t){return t?"#2bc418":"#b3bdbb"},handleSelectionChange:function(t){if(t){this.userData=t;var e=t.map((function(t){return t.userId}));this.taskForm.values=e instanceof Array?{approval:e.join(",")}:{approval:e}}},handleClose:function(t){this.userData.splice(this.userData.indexOf(t),1),this.$refs.singleTable.toggleRowSelection(t,!1)},handleCheckChange:function(t){this.taskForm.values=t instanceof Array?{approval:t.join(",")}:{approval:t}},getFlowRecordList:function(t,e){var r=this,n={procInsId:t,deployId:e};Object(a["e"])(n).then((function(t){r.flowRecordList=t.data.flowList,t.data.formData&&(r.formConf=t.data.formData,r.formConfOpen=!0)})).catch((function(t){r.goBack()}))},fillFormData:function(t,e){t.fields.forEach((function(t){var r=e[t.__vModel__];r&&(t.__config__.defaultValue=r)}))},processVariables:function(t){var e=this;t&&Object(s["f"])(t).then((function(t){e.variablesData=t.data.variables,e.variableOpen=!0}))},getNextFlowNode:function(t){var e=this,r={taskId:t};Object(l["f"])(r).then((function(t){var r=t.data;r&&(e.checkSendUser=!0,"assignee"===r.type?e.userDataList=t.data.userList:"candidateUsers"===r.type?(e.userDataList=t.data.userList,e.taskForm.multiple=!0):"candidateGroups"===r.type?(t.data.roleList.forEach((function(t){t.userId=t.roleId,t.nickName=t.roleName})),e.userDataList=t.data.roleList,e.taskForm.multiple=!1):"multiInstance"===r.type?(e.userDataList=t.data.userList,e.taskForm.multiple=!0):"fixed"===r.type&&(e.checkSendUser=!1))}))},handleComplete:function(){this.completeOpen=!0,this.completeTitle="审批流程",this.getTreeselect()},taskComplete:function(){var t=this;this.taskForm.values||!this.checkSendUser?this.taskForm.comment?Object(l["a"])(this.taskForm).then((function(e){t.msgSuccess(e.msg),t.goBack()})):this.msgError("请输入审批意见"):this.msgError("请选择流程接收人员")},handleDelegate:function(){this.taskForm.delegateTaskShow=!0,this.taskForm.defaultTaskShow=!1},handleAssign:function(){},goBack:function(){this.$store.dispatch("tagsView/delView",this.$route),this.$router.go(-1)},getData:function(t){if(t){var e=[];t.fields.forEach((function(t){var r={};if(r.label=t.__config__.label,t.__config__.defaultValue instanceof Array){var n=[];t.__config__.defaultValue.forEach((function(t){n.push(t)})),r.val=n}else r.val=t.__config__.defaultValue;e.push(r)})),this.variables=e}},submitForm:function(t){var e=this;if(t){var r=t.valData,n=t.formData;n.disabled=!0,n.formBtns=!1,this.taskForm.procDefId&&(r.variables=n,Object(s["b"])(this.taskForm.procDefId,JSON.stringify(r)).then((function(t){e.msgSuccess(t.msg),e.goBack()})))}},handleReject:function(){this.rejectOpen=!0,this.rejectTitle="驳回流程"},taskReject:function(){var t=this;this.$refs["taskForm"].validate((function(e){e&&Object(l["g"])(t.taskForm).then((function(e){t.msgSuccess(e.msg),t.goBack()}))}))},handleReturn:function(){var t=this;this.returnOpen=!0,this.returnTitle="退回流程",Object(l["h"])(this.taskForm).then((function(e){t.returnTaskList=e.data,t.taskForm.values=null}))},taskReturn:function(){var t=this;this.$refs["taskForm"].validate((function(e){e&&Object(l["i"])(t.taskForm).then((function(e){t.msgSuccess(e.msg),t.goBack()}))}))},cancelTask:function(){this.taskForm.returnTaskShow=!1,this.taskForm.defaultTaskShow=!0,this.taskForm.sendUserShow=!0,this.returnTaskList=[]},submitDeleteTask:function(){var t=this;this.$refs["taskForm"].validate((function(e){e&&Object(l["c"])(t.taskForm).then((function(e){t.msgSuccess(e.msg),t.goBack()}))}))},cancelDelegateTask:function(){this.taskForm.delegateTaskShow=!1,this.taskForm.defaultTaskShow=!0,this.taskForm.sendUserShow=!0,this.returnTaskList=[]}}},h=_,p=(r("fe13"),r("2877")),b=Object(p["a"])(h,n,o,!1,null,"79350994",null);e["default"]=b.exports},9977:function(t,e,r){var n={"./el-button.js":"aace","./el-checkbox-group.js":"9413","./el-input.js":"167d","./el-radio-group.js":"2cfa","./el-select.js":"7f29","./el-upload.js":"0f88"};function o(t){var e=a(t);return r(e)}function a(t){if(!r.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}o.keys=function(){return Object.keys(n)},o.resolve=a,t.exports=o,o.id="9977"},"9f75":function(t,e,r){"use strict";var n,o,a=r("f50d"),i=a["a"],s=r("2877"),l=Object(s["a"])(i,n,o,!1,null,null,null);e["a"]=l.exports},c0c7:function(t,e,r){"use strict";r.d(e,"h",(function(){return a})),r.d(e,"e",(function(){return i})),r.d(e,"a",(function(){return s})),r.d(e,"j",(function(){return l})),r.d(e,"c",(function(){return c})),r.d(e,"d",(function(){return u})),r.d(e,"i",(function(){return d})),r.d(e,"b",(function(){return f})),r.d(e,"f",(function(){return m})),r.d(e,"k",(function(){return _})),r.d(e,"l",(function(){return h})),r.d(e,"m",(function(){return p})),r.d(e,"g",(function(){return b}));var n=r("b775"),o=r("c38a");function a(t){return Object(n["a"])({url:"/system/user/list",method:"get",params:t})}function i(t){return Object(n["a"])({url:"/system/user/"+Object(o["e"])(t),method:"get"})}function s(t){return Object(n["a"])({url:"/system/user",method:"post",data:t})}function l(t){return Object(n["a"])({url:"/system/user",method:"put",data:t})}function c(t){return Object(n["a"])({url:"/system/user/"+t,method:"delete"})}function u(t){return Object(n["a"])({url:"/system/user/export",method:"get",params:t})}function d(t,e){var r={userId:t,password:e};return Object(n["a"])({url:"/system/user/resetPwd",method:"put",data:r})}function f(t,e){var r={userId:t,status:e};return Object(n["a"])({url:"/system/user/changeStatus",method:"put",data:r})}function m(){return Object(n["a"])({url:"/system/user/profile",method:"get"})}function _(t){return Object(n["a"])({url:"/system/user/profile",method:"put",data:t})}function h(t,e){var r={oldPassword:t,newPassword:e};return Object(n["a"])({url:"/system/user/profile/updatePwd",method:"put",params:r})}function p(t){return Object(n["a"])({url:"/system/user/profile/avatar",method:"post",data:t})}function b(){return Object(n["a"])({url:"/system/user/importTemplate",method:"get"})}},d5b1:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"containers main-box"},[r("el-button",{attrs:{type:"success",size:"small",icon:"el-icon-zoom-in"},on:{click:function(e){return t.zoomViewport(!0)}}},[t._v("放大")]),r("el-button",{attrs:{type:"warning",size:"small",icon:"el-icon-zoom-out"},on:{click:function(e){return t.zoomViewport(!1)}}},[t._v("缩小")]),r("el-button",{attrs:{type:"info",size:"small",icon:"el-icon-rank"},on:{click:t.fitViewport}},[t._v("适中")]),r("div",{ref:"flowCanvas",staticClass:"canvas"})],1)},o=[],a=r("1da1"),i=(r("159b"),r("7db0"),r("96cf"),r("99af"),r("3fb5")),s=r.n(i),l=r("88eb"),c=r("e506");function u(t){return Math.log(t)/Math.log(10)}function d(t,e){var r=u(t.min),n=u(t.max),o=Math.abs(r)+Math.abs(n);return o/e}function f(t,e){return Math.max(t.min,Math.min(t.max,e))}var m=r("87f2"),_=Math.sign||function(t){return t>=0?1:-1},h={min:.2,max:4},p=10,b=.1,g=.75;function v(t,e,r){t=t||{},this._enabled=!1,this._canvas=r,this._container=r._container,this._handleWheel=Object(m["bind"])(this._handleWheel,this),this._totalDelta=0,this._scale=t.scale||g;var n=this;e.on("canvas.init",(function(e){n._init(!1!==t.enabled)}))}v.$inject=["config.zoomScroll","eventBus","canvas"],v.prototype.scroll=function(t){this._canvas.scroll(t)},v.prototype.reset=function(){this._canvas.zoom("fit-viewport")},v.prototype.zoom=function(t,e){var r=d(h,2*p);this._totalDelta+=t,Math.abs(this._totalDelta)>b&&(this._zoom(t,e,r),this._totalDelta=0)},v.prototype._handleWheel=function(t){if(!Object(c["d"])(t.target,".djs-scrollable",!0)){var e=this._container;t.preventDefault();var r,n=t.ctrlKey,o=t.shiftKey,a=-1*this._scale;if(a*=n?0===t.deltaMode?.02:.32:0===t.deltaMode?1:16,n){var i=e.getBoundingClientRect(),s={x:t.clientX-i.left,y:t.clientY-i.top};r=Math.sqrt(Math.pow(t.deltaY,2)+Math.pow(t.deltaX,2))*_(t.deltaY)*a,this.zoom(r,s)}else r=o?{dx:a*t.deltaY,dy:0}:{dx:a*t.deltaX,dy:a*t.deltaY},this.scroll(r)}},v.prototype.stepZoom=function(t,e){var r=d(h,p);this._zoom(t,e,r)},v.prototype._zoom=function(t,e,r){var n=this._canvas,o=t>0?1:-1,a=u(n.zoom()),i=Math.round(a/r)*r;i+=r*o;var s=Math.pow(10,i);n.zoom(f(h,s),e)},v.prototype.toggle=function(t){var e=this._container,r=this._handleWheel,n=this._enabled;return"undefined"===typeof t&&(t=!n),n!==t&&c["g"][t?"bind":"unbind"](e,"wheel",r,!1),this._enabled=t,t},v.prototype._init=function(t){this.toggle(t)};var y={__init__:["zoomScroll"],zoomScroll:["type",v]},k=/^djs-cursor-.*$/;function O(t){var e=Object(c["b"])(document.body);e.removeMatching(k),t&&e.add("djs-cursor-"+t)}function w(){O(null)}var j=5e3;function D(t,e){function r(){return!1}return e=e||"element.click",t.once(e,j,r),function(){t.off(e,r)}}function C(t,e){return{x:t.x-e.x,y:t.y-e.y}}var M=r("1025"),E=15;function x(t,e){var r;function n(n){var o=r.start,a=Object(M["b"])(n),i=C(a,o);if(!r.dragging&&F(i)>E&&(r.dragging=!0,D(t),O("grab")),r.dragging){var s=r.last||r.start;i=C(a,s),e.scroll({dx:i.x,dy:i.y}),r.last=a}n.preventDefault()}function o(t){c["g"].unbind(document,"mousemove",n),c["g"].unbind(document,"mouseup",o),r=null,w()}function a(t){if(!Object(c["d"])(t.target,".djs-draggable")&&!(t.button||t.ctrlKey||t.shiftKey||t.altKey))return r={start:Object(M["b"])(t)},c["g"].bind(document,"mousemove",n),c["g"].bind(document,"mouseup",o),!0}t.on("element.mousedown",500,(function(t){return a(t.originalEvent)}))}function F(t){return Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2))}x.$inject=["eventBus","canvas"];var L={__init__:["moveCanvas"],moveCanvas:["type",x]};function I(t){l["a"].call(this,t)}s()(I,l["a"]),I.prototype._modules=[].concat(l["a"].prototype._modules,[y,L]);var T={name:"FlowView",props:{xmlData:{type:String,default:""},taskList:{type:Array,default:function(){return[]}}},data:function(){return{bpmnViewer:null}},watch:{xmlData:function(t){t&&this.getImg(t)}},mounted:function(){this.bpmnViewer&&this.bpmnViewer.destroy(),this.bpmnViewer=new I({container:this.$refs.flowCanvas,height:"calc(100vh - 200px)"}),this.getImg(this.xmlData)},methods:{getImg:function(t){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e,r.prev=1,r.next=4,n.bpmnViewer.importXML(t);case 4:n.fitViewport(),void 0!==n.taskList&&n.taskList.length>0&&n.fillColor(),r.next=11;break;case 8:r.prev=8,r.t0=r["catch"](1),console.error(r.t0.message,r.t0.warnings);case 11:case"end":return r.stop()}}),r,null,[[1,8]])})))()},setNodeColor:function(t,e,r){for(var n=0;n<t.length;n++)r.addMarker(t[n],e)},fitViewport:function(){this.zoom=this.bpmnViewer.get("canvas").zoom("fit-viewport","auto")},zoomViewport:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.zoom=this.bpmnViewer.get("canvas").zoom(),this.zoom+=t?.1:-.1,this.zoom>=.2&&this.bpmnViewer.get("canvas").zoom(this.zoom)},fillColor:function(){var t=this,e=this.bpmnViewer.get("canvas");this.bpmnViewer.getDefinitions().rootElements[0].flowElements.forEach((function(r){var n,o=t.taskList.find((function(t){return t.key===r.id})),a=t.taskList.find((function(t){return!t.completed})),i=t.taskList[t.taskList.length-1];if("bpmn:UserTask"===r.$type)o&&(e.addMarker(r.id,o.completed?"highlight":"highlight-todo"),null===(n=r.outgoing)||void 0===n||n.forEach((function(r){var n=t.taskList.find((function(t){return t.key===r.targetRef.id}));n&&(a&&o.key===a.key&&!a.completed?(e.addMarker(r.id,a.completed?"highlight":"highlight-todo"),e.addMarker(r.targetRef.id,a.completed?"highlight":"highlight-todo")):(e.addMarker(r.id,n.completed?"highlight":"highlight-todo"),e.addMarker(r.targetRef.id,n.completed?"highlight":"highlight-todo")))})));else if("bpmn:ExclusiveGateway"===r.$type){var s;if(o)e.addMarker(r.id,o.completed?"highlight":"highlight-todo"),null===(s=r.outgoing)||void 0===s||s.forEach((function(r){var n=t.taskList.find((function(t){return t.key===r.targetRef.id}));n&&(e.addMarker(r.id,n.completed?"highlight":"highlight-todo"),e.addMarker(r.targetRef.id,n.completed?"highlight":"highlight-todo"))}))}else if("bpmn:ParallelGateway"===r.$type){var l;if(o)e.addMarker(r.id,o.completed?"highlight":"highlight-todo"),null===(l=r.outgoing)||void 0===l||l.forEach((function(r){var n=t.taskList.find((function(t){return t.key===r.targetRef.id}));n&&(e.addMarker(r.id,n.completed?"highlight":"highlight-todo"),e.addMarker(r.targetRef.id,n.completed?"highlight":"highlight-todo"))}))}else if("bpmn:StartEvent"===r.$type)r.outgoing.forEach((function(n){var o=t.taskList.find((function(t){return t.key===n.targetRef.id}));if(o)return e.addMarker(n.id,"highlight"),void e.addMarker(r.id,"highlight")}));else if("bpmn:EndEvent"===r.$type&&i.key===r.id&&i.completed)return void e.addMarker(r.id,"highlight")}))}}},P=T,R=(r("6e5e"),r("2877")),q=Object(R["a"])(P,n,o,!1,null,null,null);e["default"]=q.exports},d6fc:function(t,e,r){},e099:function(t,e,r){"use strict";r.d(e,"j",(function(){return o})),r.d(e,"a",(function(){return a})),r.d(e,"c",(function(){return i})),r.d(e,"i",(function(){return s})),r.d(e,"g",(function(){return l})),r.d(e,"h",(function(){return c})),r.d(e,"f",(function(){return u})),r.d(e,"e",(function(){return d})),r.d(e,"b",(function(){return f})),r.d(e,"d",(function(){return m}));var n=r("b775");r("3fd3");function o(t){return Object(n["a"])({url:"/flowable/task/todoList",method:"get",params:t})}function a(t){return Object(n["a"])({url:"/flowable/task/complete",method:"post",data:t})}function i(t){return Object(n["a"])({url:"/flowable/task/delegate",method:"post",data:t})}function s(t){return Object(n["a"])({url:"/flowable/task/return",method:"post",data:t})}function l(t){return Object(n["a"])({url:"/flowable/task/reject",method:"post",data:t})}function c(t){return Object(n["a"])({url:"/flowable/task/returnList",method:"post",data:t})}function u(t){return Object(n["a"])({url:"/flowable/task/nextFlowNode",method:"post",data:t})}function d(t){return Object(n["a"])({url:"/system/deployment/"+t,method:"get"})}function f(t){return Object(n["a"])({url:"/system/deployment/"+t,method:"delete"})}function m(t){return Object(n["a"])({url:"/system/deployment/export",method:"get",params:t})}},f50d:function(module,__webpack_exports__,__webpack_require__){"use strict";var D_work_javaproject_ruo_yi_flowable_tongy2y_ruoyi_ui_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("ade3"),_vue_babel_helper_vue_jsx_merge_props__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("2638"),_vue_babel_helper_vue_jsx_merge_props__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_vue_babel_helper_vue_jsx_merge_props__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_array_map_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("d81d"),core_js_modules_es_array_map_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_array_map_js__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("159b"),core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_object_keys_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("b64b"),core_js_modules_es_object_keys_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_object_keys_js__WEBPACK_IMPORTED_MODULE_4__),_utils_index__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("ed08"),_components_render_render_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("4758"),ruleTrigger={"el-input":"blur","el-input-number":"blur","el-select":"change","el-radio-group":"change","el-checkbox-group":"change","el-cascader":"change","el-time-picker":"change","el-date-picker":"change","el-rate":"change"},layouts={colFormItem:function(t,e){var r=e.__config__,n=buildListeners.call(this,e),o=r.labelWidth?"".concat(r.labelWidth,"px"):null;return!1===r.showLabel&&(o="0"),t("el-col",{attrs:{span:r.span}},[t("el-form-item",{attrs:{"label-width":o,prop:e.__vModel__,label:r.showLabel?r.label:""}},[t(_components_render_render_js__WEBPACK_IMPORTED_MODULE_6__["a"],_vue_babel_helper_vue_jsx_merge_props__WEBPACK_IMPORTED_MODULE_1___default()([{attrs:{conf:e}},{on:n}]))])])},rowFormItem:function(t,e){var r=renderChildren.apply(this,arguments);return"flex"===e.type&&(r=t("el-row",{attrs:{type:e.type,justify:e.justify,align:e.align}},[r])),t("el-col",{attrs:{span:e.span}},[t("el-row",{attrs:{gutter:e.gutter}},[r])])}};function renderFrom(t){var e=this.formConfCopy;return t("el-row",{attrs:{gutter:e.gutter}},[t("el-form",_vue_babel_helper_vue_jsx_merge_props__WEBPACK_IMPORTED_MODULE_1___default()([{attrs:{size:e.size,"label-position":e.labelPosition,disabled:e.disabled,"label-width":"".concat(e.labelWidth,"px")},ref:e.formRef},{props:{model:this[e.formModel]}},{attrs:{rules:this[e.formRules]}}]),[renderFormItem.call(this,t,e.fields),e.formBtns&&formBtns.call(this,t)])])}function formBtns(t){return t("el-col",[t("el-form-item",{attrs:{size:"large"}},[t("el-button",{attrs:{type:"primary"},on:{click:this.submitForm}},["提交"]),t("el-button",{on:{click:this.resetForm}},["重置"])])])}function renderFormItem(t,e){var r=this;return e.map((function(e){var n=e.__config__,o=layouts[n.layout];if(o)return o.call(r,t,e);throw new Error("没有与".concat(n.layout,"匹配的layout"))}))}function renderChildren(t,e){var r=e.__config__;return Array.isArray(r.children)?renderFormItem.call(this,t,r.children):null}function setValue(t,e,r){this.$set(e,"defaultValue",t),this.$set(this[this.formConf.formModel],r.__vModel__,t)}function buildListeners(t){var e=this,r=t.__config__,n=this.formConf.__methods__||{},o={};return Object.keys(n).forEach((function(t){o[t]=function(r){return n[t].call(e,r)}})),o.input=function(n){return setValue.call(e,n,r,t)},o}__webpack_exports__["a"]={components:{render:_components_render_render_js__WEBPACK_IMPORTED_MODULE_6__["a"]},props:{formConf:{type:Object,required:!0}},data:function(){var t,e=(t={formConfCopy:Object(_utils_index__WEBPACK_IMPORTED_MODULE_5__["d"])(this.formConf)},Object(D_work_javaproject_ruo_yi_flowable_tongy2y_ruoyi_ui_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__["a"])(t,this.formConf.formModel,{}),Object(D_work_javaproject_ruo_yi_flowable_tongy2y_ruoyi_ui_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__["a"])(t,this.formConf.formRules,{}),t);return this.initFormData(e.formConfCopy.fields,e[this.formConf.formModel]),this.buildRules(e.formConfCopy.fields,e[this.formConf.formRules]),e},methods:{initFormData:function(t,e){var r=this;t.forEach((function(t){var n=t.__config__;t.__vModel__&&(e[t.__vModel__]=n.defaultValue),n.children&&r.initFormData(n.children,e)}))},buildRules:function buildRules(componentList,rules){var _this4=this;componentList.forEach((function(cur){var config=cur.__config__;if(Array.isArray(config.regList)){if(config.required){var required={required:config.required,message:cur.placeholder};Array.isArray(config.defaultValue)&&(required.type="array",required.message="请至少选择一个".concat(config.label)),void 0===required.message&&(required.message="".concat(config.label,"不能为空")),config.regList.push(required)}rules[cur.__vModel__]=config.regList.map((function(item){return item.pattern&&(item.pattern=eval(item.pattern)),item.trigger=ruleTrigger&&ruleTrigger[config.tag],item}))}config.children&&_this4.buildRules(config.children,rules)}))},resetForm:function(){this.formConfCopy=Object(_utils_index__WEBPACK_IMPORTED_MODULE_5__["d"])(this.formConf),this.$refs[this.formConf.formRef].resetFields()},submitForm:function(){var t=this;this.$refs[this.formConf.formRef].validate((function(e){if(!e)return!1;var r={formData:t.formConfCopy,valData:t[t.formConf.formModel]};return t.$emit("submit",r),!0}))},getData:function(){this.$emit("getData",this[this.formConf.formModel])}},render:function(t){return renderFrom.call(this,t)}}},fcb7:function(t,e,r){"use strict";r.d(e,"d",(function(){return o})),r.d(e,"e",(function(){return a})),r.d(e,"c",(function(){return i})),r.d(e,"g",(function(){return s})),r.d(e,"f",(function(){return l})),r.d(e,"a",(function(){return c})),r.d(e,"h",(function(){return u})),r.d(e,"b",(function(){return d}));var n=r("b775");function o(t){return Object(n["a"])({url:"/system/dept/list",method:"get",params:t})}function a(t){return Object(n["a"])({url:"/system/dept/list/exclude/"+t,method:"get"})}function i(t){return Object(n["a"])({url:"/system/dept/"+t,method:"get"})}function s(){return Object(n["a"])({url:"/system/dept/treeselect",method:"get"})}function l(t){return Object(n["a"])({url:"/system/dept/roleDeptTreeselect/"+t,method:"get"})}function c(t){return Object(n["a"])({url:"/system/dept",method:"post",data:t})}function u(t){return Object(n["a"])({url:"/system/dept",method:"put",data:t})}function d(t){return Object(n["a"])({url:"/system/dept/"+t,method:"delete"})}},fe13:function(t,e,r){"use strict";r("d6fc")}}]);